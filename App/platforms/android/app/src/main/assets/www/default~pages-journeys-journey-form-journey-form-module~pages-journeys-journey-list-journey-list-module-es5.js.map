{"version":3,"sources":["webpack:///src/app/pages/journeys/journey-form/journey-form.page.html","webpack:///src/app/pages/journeys/journey-form/journey-form.page.ts","webpack:///src/app/services/v1/geocode.service.ts"],"names":["JourneyFormPage","formBuilder","ngZone","orderService","toastComponent","loadingSpinnerComponent","router","geocodeService","modalController","locationService","loading","searching","locationExists","searchInputFormControl","locations","filteredLocations","hasNewOrder","defaultLat","defaultLng","form","group","location_name","required","address","city","notes","opening_hours","phones","ngOnInit","valueChanges","subscribe","val","controls","setValue","getLocations","response","error","submit","geocodeAddress","storeOrder","body","type","location_id","location","id","value","store","navigateByUrl","resetForm","country","mapQuestGeocode","then","result","showLocationMap","lat","lng","err","GMGeocodeAddress","create","component","cssClass","componentProps","modal","present","onDidDismiss","data","success","handleResults","locality","administrativeAreaLevel1","administrativeAreaLevel2","results","length","address_components","map","addressComponent","types","long_name","name","administrative_area_level_1","administrative_area_level_2","storeLocation","message","custom_message","presentToast","selectLocation","disable","search","event","keyword","detail","toLowerCase","filter","includes","full_address","clear","enable","dismiss","GeocodeService","http","addressToGeocode","Promise","resolve","reject","geocodeMapQuestAddress","latLng","self","geocoder","google","maps","Geocoder","geocode","status","GeocoderStatus","OK","run","geometry","ZERO_RESULTS","key","mapquest","endpoint","url","get"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoBI;;AAA8D;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAC5D;;AACE;;AAAG;;AAAG;;AAAiB;;AAAI;;AAC3B;;AAAG;;AAAyB;;AAC9B;;AACF;;;;;;AAHU;;AAAA;;AACH;;AAAA;;;;;;AAJT;;AACE;;AAMF;;;;;;AANiC;;AAAA;;;;;;AAa/B;;AAAyE;;AAA+B;;;;;;AAMxG;;AAAmE;;AAA+B;;;;;;AAXpG;;AACE;;AACE;;AAA+B;;AAAU;;AACzC;;AACF;;AACA;;AAEA;;AACE;;AAA+B;;AAAa;;AAC5C;;AACF;;AACA;;AAEA;;AACE;;AAA+B;;AAAM;;AACrC;;AACF;;AACA;;AACE;;AAA+B;;AAAyB;;AACxD;;AACF;;AACA;;AACE;;AAA+B;;AAAQ;;AACvC;;AACF;;AACA;;AACE;;AAA+B;;AAAmB;;AAClD;;AACF;;AACF;;;;;;AA7BM;;AAK2B;;AAAA;;AAMA;;AAAA;;;;UCtBtBA,e;AAcX,iCAAoBC,WAApB,EACoBC,MADpB,EAEoBC,YAFpB,EAGoBC,cAHpB,EAIoBC,uBAJpB,EAKoBC,MALpB,EAMoBC,cANpB,EAOoBC,eAPpB,EAQoBC,eARpB,EAQsD;AAAA;;AARlC,eAAAR,WAAA,GAAAA,WAAA;AACA,eAAAC,MAAA,GAAAA,MAAA;AACA,eAAAC,YAAA,GAAAA,YAAA;AACA,eAAAC,cAAA,GAAAA,cAAA;AACA,eAAAC,uBAAA,GAAAA,uBAAA;AACA,eAAAC,MAAA,GAAAA,MAAA;AACA,eAAAC,cAAA,GAAAA,cAAA;AACA,eAAAC,eAAA,GAAAA,eAAA;AACA,eAAAC,eAAA,GAAAA,eAAA;AArBpB,eAAAC,OAAA,GAAU,KAAV;AAEA,eAAAC,SAAA,GAAY,IAAZ;AACA,eAAAC,cAAA,GAAiB,KAAjB;AACA,eAAAC,sBAAA,GAAyB,IAAI,0DAAJ,EAAzB;AACA,eAAAC,SAAA,GAAwB,EAAxB;AACA,eAAAC,iBAAA,GAAgC,EAAhC;AAGA,eAAAC,WAAA,GAAc,KAAd;AACA,eAAAC,UAAA,GAAa,CAAC,UAAd;AACA,eAAAC,UAAA,GAAa,CAAC,UAAd;AAWE,eAAKC,IAAL,GAAY,KAAKlB,WAAL,CAAiBmB,KAAjB,CAAuB;AACjCC,yBAAa,EAAE,CAAC,EAAD,EAAK,0DAAWC,QAAhB,CADkB;AAEjCC,mBAAO,EAAE,CAAC,EAAD,EAAK,0DAAWD,QAAhB,CAFwB;AAGjCE,gBAAI,EAAE,CAAC,cAAD,EAAiB,0DAAWF,QAA5B,CAH2B;AAIjCG,iBAAK,EAAE,CAAC,EAAD,CAJ0B;AAKjCC,yBAAa,EAAE,CAAC,EAAD,CALkB;AAMjCC,kBAAM,EAAE,CAAC,EAAD;AANyB,WAAvB,CAAZ;AAQD;;;;iBAED,SAAAC,QAAQ;AAAA;;AACN;AACA;AACA;AACA,iBAAKf,sBAAL,CAA4BgB,YAA5B,CAAyCC,SAAzC,CAAmD,UAAAC,GAAG,EAAI;AACxD,mBAAI,CAACZ,IAAL,CAAUa,QAAV,CAAmBX,aAAnB,CAAiCY,QAAjC,CAA0CF,GAA1C;;AACA,mBAAI,CAACZ,IAAL,CAAUa,QAAV,CAAmBT,OAAnB,CAA2BU,QAA3B,CAAoCF,GAApC;AACD,aAHD;AAID;;;iBAED,SAAAG,YAAY,GAAG;AAAA;;AACb,iBAAKzB,eAAL,CAAqByB,YAArB,GACGJ,SADH,CACa,UAACK,QAAD,EAAmB;AAC5B,oBAAI,CAACrB,SAAL,GAAiBqB,QAAQ,CAACrB,SAA1B;AACD,aAHH,EAGK,UAAAsB,KAAK,EAAI,CACV;AACD,aALH,EAKK,YAAM,CACP;AACD,aAPH;AAQD;;;iBAED,SAAAC,MAAM,GAAG;AACP,gBAAI,CAAC,KAAKzB,cAAV,EAA0B;AACxB,mBAAK0B,cAAL;AACD,aAFD,MAEO;AACL,mBAAKC,UAAL;AACD;AACF;;;iBAED,SAAAA,UAAU,GAAG;AAAA;;AACX,gBAAMC,IAAI,GAAG;AACXC,kBAAI,EAAE,SADK;AAEXC,yBAAW,EAAE,KAAKC,QAAL,CAAcC,EAFhB;AAGXnB,mBAAK,EAAE,KAAKN,IAAL,CAAU0B,KAAV,CAAgBpB,KAHZ;AAIXC,2BAAa,EAAE,KAAKP,IAAL,CAAU0B,KAAV,CAAgBnB,aAJpB;AAKXC,oBAAM,EAAE,KAAKR,IAAL,CAAU0B,KAAV,CAAgBlB;AALb,aAAb;AAOA,iBAAKxB,YAAL,CAAkB2C,KAAlB,CAAwBN,IAAxB,EACGV,SADH,CACa,UAACK,QAAD,EAAmB;AAC1B;AACA;AACA,oBAAI,CAAC7B,MAAL,CAAYyC,aAAZ,CAA0B,cAA1B;AACD,aALL,EAKO,UAAAX,KAAK,EAAI,CACV;AACD,aAPL,EAQI,YAAM;AACJ,oBAAI,CAACY,SAAL;;AACA,oBAAI,CAACnC,sBAAL,CAA4BoB,QAA5B,CAAqC,EAArC;AACD,aAXL;AAYD;;;iBAED,SAAAK,cAAc,GAAG;AAAA;;AACf,gBAAMf,OAAO,GAAG,KAAKJ,IAAL,CAAU0B,KAAV,CAAgBxB,aAAhB,GAAgC,IAAhC,GACd,KAAKF,IAAL,CAAU0B,KAAV,CAAgBtB,OADF,GACY,IADZ,GAEd,KAAKJ,IAAL,CAAU0B,KAAV,CAAgBrB,IAFlB;AAGA,gBAAMyB,OAAO,GAAG,WAAhB;AACA,iBAAK1C,cAAL,CAAoB2C,eAApB,CAAoC3B,OAApC,EAA6C0B,OAA7C,EAAsDE,IAAtD,CAA2D,UAACC,MAAD,EAAiB;AAC1E,oBAAI,CAACC,eAAL,CAAqBD,MAAM,CAACE,GAA5B,EAAiCF,MAAM,CAACG,GAAxC;AACD,aAFD,WAES,UAAAC,GAAG,EAAI;AACd,oBAAI,CAACjD,cAAL,CAAoBkD,gBAApB,CAAqClC,OAArC,EAA8C0B,OAA9C,EAAuDE,IAAvD,CAA4D,UAACC,MAAD,EAAiB;AAC3E,sBAAI,CAACC,eAAL,CAAqBD,MAAM,CAACE,GAA5B,EAAiCF,MAAM,CAACG,GAAxC;AACD,eAFD,WAES,UAAAnB,KAAK,EAAI;AAChB,sBAAI,CAACiB,eAAL,CAAqB,MAAI,CAACpC,UAA1B,EAAsC,MAAI,CAACC,UAA3C;AACD,eAJD;AAKD,aARD;AASD;;;iBAEK,SAAAmC,eAAe,CAACC,GAAD,EAAcC,GAAd,EAA2B;;;;;;;;;AAChC,2BAAM,KAAK/C,eAAL,CAAqBkD,MAArB,CAA4B;AAC9CC,+BAAS,EAAE,2GADmC;AAE9CC,8BAAQ,EAAE,yBAFoC;AAG9CC,oCAAc,EAAE;AACdP,2BAAG,EAAHA,GADc;AAEdC,2BAAG,EAAHA;AAFc;AAH8B,qBAA5B,CAAN;;;AAARO,yB;;AAQN,2BAAMA,KAAK,CAACC,OAAN,EAAN;;;AAEAD,yBAAK,CAACE,YAAN,GAAqBb,IAArB,CAA0B,UAAAc,IAAI,EAAI;AAChC,0BAAIA,IAAI,CAACA,IAAL,IAAaA,IAAI,CAACA,IAAL,CAAUC,OAA3B,EAAoC;AAClC,8BAAI,CAACC,aAAL,CAAmBF,IAAI,CAACA,IAAL,CAAUX,GAA7B,EAAkCW,IAAI,CAACA,IAAL,CAAUV,GAA5C;AACD;AACF,qBAJD;;;;;;;AAKD;;;iBAED,SAAAY,aAAa,CAACb,GAAD,EAAMC,GAAN,EAAW;AACtB,gBAAIa,QAAQ,GAAG,EAAf;AACA,gBAAIC,wBAAwB,GAAG,EAA/B;AACA,gBAAIC,wBAAwB,GAAG,EAA/B;;AAEA,gBAAI,KAAKC,OAAL,CAAaC,MAAb,GAAsB,CAA1B,EAA6B;AAC3B,mBAAKD,OAAL,CAAa,CAAb,EAAgBE,kBAAhB,CAAmCC,GAAnC,CAAuC,UAAAC,gBAAgB,EAAI;AACzDA,gCAAgB,CAACC,KAAjB,CAAuBF,GAAvB,CAA2B,UAAAjC,IAAI,EAAI;AACjC,sBAAIA,IAAI,KAAK,UAAb,EAAyB;AACvB2B,4BAAQ,GAAGO,gBAAgB,CAACE,SAA5B;AACD,mBAFD,MAEO,IAAIpC,IAAI,KAAK,6BAAb,EAA4C;AACjD4B,4CAAwB,GAAGM,gBAAgB,CAACE,SAA5C;AACD,mBAFM,MAEA,IAAIpC,IAAI,KAAK,6BAAb,EAA4C;AACjD6B,4CAAwB,GAAGK,gBAAgB,CAACE,SAA5C;AACD;AACF,iBARD;AASD,eAVD;AAWD;;AAED,gBAAMrC,IAAI,GAAG;AACXC,kBAAI,EAAE,SADK;AAEXqC,kBAAI,EAAE,KAAK3D,IAAL,CAAU0B,KAAV,CAAgBxB,aAFX;AAGXE,qBAAO,EAAE,KAAKJ,IAAL,CAAU0B,KAAV,CAAgBtB,OAHd;AAIXC,kBAAI,EAAE,KAAKL,IAAL,CAAU0B,KAAV,CAAgBrB,IAJX;AAKXC,mBAAK,EAAE,KAAKN,IAAL,CAAU0B,KAAV,CAAgBpB,KALZ;AAMXC,2BAAa,EAAE,KAAKP,IAAL,CAAU0B,KAAV,CAAgBnB,aANpB;AAOXC,oBAAM,EAAE,KAAKR,IAAL,CAAU0B,KAAV,CAAgBlB,MAPb;AAQXyC,sBAAQ,EAARA,QARW;AASXW,yCAA2B,EAAEV,wBATlB;AAUXW,yCAA2B,EAAEV,wBAVlB;AAWXhB,iBAAG,EAAHA,GAXW;AAYXC,iBAAG,EAAHA;AAZW,aAAb;AAcA,iBAAK0B,aAAL,CAAmBzC,IAAnB;AACD;;;iBAED,SAAAyC,aAAa,CAACzC,IAAD,EAAO;AAAA;;AAClB,iBAAK/B,eAAL,CAAqBwE,aAArB,CAAmCzC,IAAnC,EACGV,SADH,CACa,UAACK,QAAD,EAAmB;AAC1B,oBAAI,CAACnB,WAAL,GAAmB,IAAnB;;AACA,oBAAI,CAACV,MAAL,CAAYyC,aAAZ,CAA0B,cAA1B;AACD,aAJL,EAIO,UAAAX,KAAK,EAAI;;;AACV,kBAAM8C,OAAO,GAAG,OAAA9C,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAEA,KAAP,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAE+C,cAAd,KAAgC,mCAAhD;;AACA,oBAAI,CAAC/E,cAAL,CAAoBgF,YAApB,CAAiCF,OAAjC,EAA0C,QAA1C,EAAoD,IAApD;AACD,aAPL,EAQI,YAAM;AACJ;AACA,oBAAI,CAAClC,SAAL;;AACA,oBAAI,CAACnC,sBAAL,CAA4BoB,QAA5B,CAAqC,EAArC;AACD,aAZL;AAaD;;;iBAED,SAAAoD,cAAc,CAAC1C,QAAD,EAAqB;AACjC,iBAAK/B,cAAL,GAAsB,IAAtB;AACA,iBAAK+B,QAAL,GAAgBA,QAAhB;AACA,iBAAKhC,SAAL,GAAiB,KAAjB;AACA,iBAAKI,iBAAL,GAAyB,EAAzB;AACA,iBAAKI,IAAL,CAAUa,QAAV,CAAmBX,aAAnB,CAAiCY,QAAjC,CAA0CU,QAAQ,CAACmC,IAAnD;AACA,iBAAK3D,IAAL,CAAUa,QAAV,CAAmBX,aAAnB,CAAiCiE,OAAjC;AACA,iBAAKnE,IAAL,CAAUa,QAAV,CAAmBT,OAAnB,CAA2B+D,OAA3B;AACA,iBAAKnE,IAAL,CAAUa,QAAV,CAAmBT,OAAnB,CAA2BU,QAA3B,CAAoCU,QAAQ,CAACpB,OAA7C;AACA,iBAAKJ,IAAL,CAAUa,QAAV,CAAmBT,OAAnB,CAA2B+D,OAA3B;AACA,iBAAKnE,IAAL,CAAUa,QAAV,CAAmBR,IAAnB,CAAwBS,QAAxB,CAAiCU,QAAQ,CAACnB,IAA1C;AACA,iBAAKL,IAAL,CAAUa,QAAV,CAAmBR,IAAnB,CAAwB8D,OAAxB;AAEA,iBAAKnE,IAAL,CAAUa,QAAV,CAAmBP,KAAnB,CAAyBQ,QAAzB,CAAkCU,QAAQ,CAAClB,KAA3C;AACA,iBAAKN,IAAL,CAAUa,QAAV,CAAmBN,aAAnB,CAAiCO,QAAjC,CAA0CU,QAAQ,CAACjB,aAAnD;AACA,iBAAKP,IAAL,CAAUa,QAAV,CAAmBL,MAAnB,CAA0BM,QAA1B,CAAmCU,QAAQ,CAAChB,MAA5C;AACD;;;iBAED,SAAA4D,MAAM,CAACC,KAAD,EAAQ;AACZ,iBAAK7E,SAAL,GAAiB,IAAjB;AACA,iBAAKC,cAAL,GAAsB,KAAtB;AACA,iBAAKoC,SAAL;AACA,gBAAMyC,OAAO,GAAGD,KAAK,CAACE,MAAN,CAAa7C,KAAb,CAAmB8C,WAAnB,EAAhB;;AACA,gBAAIF,OAAO,KAAK,EAAhB,EAAoB;AAClB,mBAAK1E,iBAAL,GAAyB,EAAzB;AACD,aAFD,MAEO;AACL,mBAAKA,iBAAL,GAAyB,KAAKD,SAAL,CAAe8E,MAAf,CAAsB,UAAAjD,QAAQ;AAAA,uBACrDA,QAAQ,CAACmC,IAAT,CAAca,WAAd,GAA4BE,QAA5B,CAAqCJ,OAArC,KACG9C,QAAQ,CAACmD,YAAT,CAAsBH,WAAtB,GAAoCE,QAApC,CAA6CJ,OAA7C,CAFkD;AAAA,eAA9B,CAAzB;AAGD;;AACD,gBAAI,KAAK1E,iBAAL,CAAuByD,MAAvB,IAAiC,CAArC,EAAwC;AACtC,mBAAK7D,SAAL,GAAiB,KAAjB;AACD;AACF;;;iBAED,SAAAoF,KAAK,GAAG;AACN,iBAAKpF,SAAL,GAAiB,KAAjB;AACA,iBAAKI,iBAAL,GAAyB,EAAzB;AACD;;;iBAED,SAAAiC,SAAS,GAAG;AACV,iBAAK7B,IAAL,CAAUa,QAAV,CAAmBX,aAAnB,CAAiCY,QAAjC,CAA0C,KAAKpB,sBAAL,CAA4BgC,KAAtE;AACA,iBAAK1B,IAAL,CAAUa,QAAV,CAAmBT,OAAnB,CAA2BU,QAA3B,CAAoC,EAApC;AACA,iBAAKd,IAAL,CAAUa,QAAV,CAAmBR,IAAnB,CAAwBS,QAAxB,CAAiC,YAAjC;AACA,iBAAKd,IAAL,CAAUa,QAAV,CAAmBP,KAAnB,CAAyBQ,QAAzB,CAAkC,EAAlC;AACA,iBAAKd,IAAL,CAAUa,QAAV,CAAmBN,aAAnB,CAAiCO,QAAjC,CAA0C,EAA1C;AACA,iBAAKd,IAAL,CAAUa,QAAV,CAAmBL,MAAnB,CAA0BM,QAA1B,CAAmC,EAAnC;AAEA,iBAAKd,IAAL,CAAUa,QAAV,CAAmBX,aAAnB,CAAiC2E,MAAjC;AACA,iBAAK7E,IAAL,CAAUa,QAAV,CAAmBT,OAAnB,CAA2ByE,MAA3B;AACA,iBAAK7E,IAAL,CAAUa,QAAV,CAAmBR,IAAnB,CAAwBwE,MAAxB;AACA,iBAAK7E,IAAL,CAAUa,QAAV,CAAmBP,KAAnB,CAAyBuE,MAAzB;AACA,iBAAK7E,IAAL,CAAUa,QAAV,CAAmBN,aAAnB,CAAiCsE,MAAjC;AACA,iBAAK7E,IAAL,CAAUa,QAAV,CAAmBL,MAAnB,CAA0BqE,MAA1B;AACD;;;iBAED,SAAAC,OAAO,GAAG;AACR,iBAAKzF,eAAL,CAAqByF,OAArB,CAA6B;AAACjF,yBAAW,EAAE,KAAKA;AAAnB,aAA7B;AACD;;;;;yBApOUhB,e,EAAe,2H,EAAA,qH,EAAA,wI,EAAA,iJ,EAAA,8K,EAAA,uH,EAAA,6I,EAAA,+H,EAAA,8I;AAAA,O;;;cAAfA,e;AAAe,yC;AAAA,iB;AAAA,e;AAAA,6zB;AAAA;AAAA;ADjB5B;;AACE;;AACE;;AACE;;AAAY;AAAA,qBAAS,IAAAiG,OAAA,EAAT;AAAkB,aAAlB;;AACV;;AACF;;AACF;;AACA;;AAAW;;AAAiB;;AAC9B;;AACF;;AAEA;;AACE;;AAGe;AAAA,qBAAa,IAAAV,MAAA,QAAb;AAA2B,aAA3B,EAA4B,UAA5B,EAA4B;AAAA,qBAChB,IAAAQ,KAAA,EADgB;AACT,aADnB;;AAEf;;AAEA;;AASA;;AA8BF;;AAEA;;AACE;;AACE;;AAIY;AAAA,qBAAS,IAAA1D,MAAA,EAAT;AAAiB,aAAjB;;AACV;;AACF;;AACF;;AACF;;;;AA1DiB;;AAAA;;AAOJ;;AAAA;;AASe;;AAAA;;AAoCZ;;AAAA;;;;;;;;;;;;;;;;;;;;;AEhEhB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;UAOa6D,c;AAGX,gCAAoBhG,MAApB,EACoBiG,IADpB,EACsC;AAAA;;AADlB,eAAAjG,MAAA,GAAAA,MAAA;AACA,eAAAiG,IAAA,GAAAA,IAAA;AACnB;;;;iBAED,SAAAjD,eAAe,CAACkD,gBAAD,EAAmBnD,OAAnB,EAA0B;AAAA;;AACvC,mBAAO,IAAIoD,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,kBAAMhF,OAAO,aAAM6E,gBAAN,cAA0BnD,OAA1B,CAAb;;AACA,oBAAI,CAACuD,sBAAL,CAA4BjF,OAA5B,EACGO,SADH,CACa,UAACK,QAAD,EAAmB;AAC5B,oBAAM8B,IAAI,GAAG9B,QAAb;;AACA,oBAAI8B,IAAI,CAACM,OAAL,IAAgBN,IAAI,CAACM,OAAL,CAAaC,MAAb,GAAsB,CAA1C,EAA6C;AAC3C,sBAAIP,IAAI,CAACM,OAAL,CAAa,CAAb,EAAgBzD,SAAhB,IAA6BmD,IAAI,CAACM,OAAL,CAAa,CAAb,EAAgBzD,SAAhB,CAA0B0D,MAA1B,GAAmC,CAApE,EAAuE;AACrE,wBAAIP,IAAI,CAACM,OAAL,CAAa,CAAb,EAAgBzD,SAAhB,CAA0B,CAA1B,EAA6B2F,MAAjC,EAAyC;AACvC,0BAAMnD,GAAG,GAAGW,IAAI,CAACM,OAAL,CAAa,CAAb,EAAgBzD,SAAhB,CAA0B,CAA1B,EAA6B2F,MAA7B,CAAoCnD,GAAhD;AACA,0BAAMC,GAAG,GAAGU,IAAI,CAACM,OAAL,CAAa,CAAb,EAAgBzD,SAAhB,CAA0B,CAA1B,EAA6B2F,MAA7B,CAAoClD,GAAhD;AACJ+C,6BAAO,CAAC;AAAChD,2BAAG,EAAHA,GAAD;AAAMC,2BAAG,EAAHA;AAAN,uBAAD,CAAP;AACD;AACE;AACF,iBARD,MAQO;AACLgD,wBAAM;AACP;AACF,eAdH,EAcK,UAAAnE,KAAK,EAAI;AACVmE,sBAAM,CAACnE,KAAD,CAAN;AACD,eAhBH;AAiBD,aAnBM,CAAP;AAoBD;;;iBAED,SAAAqB,gBAAgB,CAAC2C,gBAAD,EAAmBnD,OAAnB,EAA0B;AAAA;;AACxC,mBAAO,IAAIoD,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,kBAAMG,IAAI,GAAG,MAAb;AACA,kBAAMnF,OAAO,aAAM6E,gBAAN,cAA0BnD,OAA1B,CAAb;AACA,kBAAM0D,QAAQ,GAAG,IAAIC,MAAM,CAACC,IAAP,CAAYC,QAAhB,EAAjB,CAHsC,CAItC;;AACAH,sBAAQ,CAACI,OAAT,CAAiB;AAACxF,uBAAO,EAAPA;AAAD,eAAjB,EAA4B,UAACgD,OAAD,EAAUyC,MAAV,EAAqB;AAC/C,oBAAIA,MAAM,KAAKJ,MAAM,CAACC,IAAP,CAAYI,cAAZ,CAA2BC,EAA1C,EAA8C;AAC5CR,sBAAI,CAACxG,MAAL,CAAYiH,GAAZ,CAAgB,YAAM;AACpBT,wBAAI,CAACnC,OAAL,GAAeA,OAAf;AACA,wBAAMjB,GAAG,GAAGiB,OAAO,CAAC,CAAD,CAAP,CAAW6C,QAAX,CAAoBzE,QAApB,CAA6BW,GAA7B,EAAZ;AACA,wBAAMC,GAAG,GAAGgB,OAAO,CAAC,CAAD,CAAP,CAAW6C,QAAX,CAAoBzE,QAApB,CAA6BY,GAA7B,EAAZ;AACA+C,2BAAO,CAAC;AAAChD,yBAAG,EAAHA,GAAD;AAAMC,yBAAG,EAAHA;AAAN,qBAAD,CAAP;AACD,mBALD;AAMD,iBAPD,MAOO;AACLgD,wBAAM,CAACS,MAAD,CAAN,CADK,CAEL;;AACA,sBAAIA,MAAM,KAAKJ,MAAM,CAACC,IAAP,CAAYI,cAAZ,CAA2BI,YAA1C,EAAwD,CACtD;AACD;AACF;AACF,eAfD;AAgBD,aArBM,CAAP;AAsBD;;;iBAED,SAAAb,sBAAsB,CAACjF,OAAD,EAAU;AAC9B,gBAAM+F,GAAG,GAAG,sEAAYC,QAAZ,CAAqBD,GAAjC;AACA,gBAAME,QAAQ,GAAG,iDAAjB;AACA,gBAAMC,GAAG,aAAMD,QAAN,kBAAsBF,GAAtB,uBAAsC/F,OAAtC,6FAAT;AACA,mBAAO,KAAK4E,IAAL,CAAUuB,GAAV,WAAiBD,GAAjB,EAAP;AACD;;;;;yBA5DUvB,c,EAAc,4G,EAAA,uH;AAAA,O;;;eAAdA,c;AAAc,iBAAdA,cAAc,K;AAAA,oBAFb","file":"default~pages-journeys-journey-form-journey-form-module~pages-journeys-journey-list-journey-list-module-es5.js","sourcesContent":["<ion-header no-border>\n  <ion-toolbar color=\"primary\">\n    <ion-buttons slot=\"end\">\n      <ion-button (click)=\"dismiss()\">\n        <ion-icon slot=\"icon-only\" name=\"close\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n    <ion-title>AGREGAR UBICACIÓN</ion-title>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content class=\"ion-padding\">\n  <ion-searchbar [formControl]=\"searchInputFormControl\"\n                 placeholder=\"Buscar\"\n                 debounce=\"500\"\n                 (ionChange)=\"search($event)\"\n                 (ionClear)=\"clear()\">\n  </ion-searchbar>\n\n  <ion-list *ngIf=\"filteredLocations.length > 0 && searching\">\n    <ion-item *ngFor=\"let location of filteredLocations\" tappable (click)=\"selectLocation(location)\">\n      <ion-label class=\"ion-text-wrap\">\n        <p><b>{{location.name}}</b></p>\n        <p>{{location.full_address}}</p>\n      </ion-label>\n    </ion-item>\n  </ion-list>\n\n  <form [formGroup]=\"form\" *ngIf=\"filteredLocations.length <= 0 && !searching\">\n    <ion-item>\n      <ion-label position=\"floating\">Nombre (*)</ion-label>\n      <ion-input formControlName=\"location_name\"></ion-input>\n    </ion-item>\n    <p class=\"form-error-message\" *ngIf=\"form.controls.location_name.errors\">Por favor introduzca este campo</p>\n\n    <ion-item>\n      <ion-label position=\"floating\">Dirección (*)</ion-label>\n      <ion-textarea rows=\"5\" formControlName=\"address\"></ion-textarea>\n    </ion-item>\n    <p class=\"form-error-message\" *ngIf=\"form.controls.address.errors\">Por favor introduzca este campo</p>\n\n    <ion-item>\n      <ion-label position=\"floating\">Ciudad</ion-label>\n      <ion-input formControlName=\"city\"></ion-input>\n    </ion-item>\n    <ion-item>\n      <ion-label position=\"floating\">Nota de ayuda para llegar</ion-label>\n      <ion-textarea rows=\"5\" formControlName=\"notes\"></ion-textarea>\n    </ion-item>\n    <ion-item>\n      <ion-label position=\"floating\">Horarios</ion-label>\n      <ion-textarea rows=\"2\" formControlName=\"opening_hours\"></ion-textarea>\n    </ion-item>\n    <ion-item>\n      <ion-label position=\"floating\">Números telefónicos</ion-label>\n      <ion-textarea rows=\"2\" formControlName=\"phones\"></ion-textarea>\n    </ion-item>\n  </form>\n</ion-content>\n\n<ion-footer>\n  <ion-toolbar>\n    <ion-button color=\"primary\"\n                shape=\"round\"\n                [disabled]=\"form.value.location_name === '' || form.value.address === '' || form.value.city === ''\"\n                size=\"full\"\n                (click)=\"submit()\">\n      AGREGAR\n    </ion-button>\n  </ion-toolbar>\n</ion-footer>\n\n","import {Component, NgZone, OnInit} from '@angular/core';\nimport {FormBuilder, FormControl, FormGroup, Validators} from '@angular/forms';\nimport {Location} from '../../../interfaces/Location';\nimport {OrderService} from '../../../services/v1/order.service';\nimport {ToastComponent} from '../../../components/toast/toast.component';\nimport {LoadingSpinnerComponent} from '../../../components/loading-spinner/loading-spinner.component';\nimport {Router} from '@angular/router';\nimport {ModalController} from '@ionic/angular';\nimport {LocationService} from '../../../services/v1/location.service';\nimport {LocationMapComponent} from '../../../components/modals/location-map/location-map.component';\nimport {GeocodeService} from '../../../services/v1/geocode.service';\n\n@Component({\n  selector: 'app-journey-form',\n  templateUrl: './journey-form.page.html',\n  styleUrls: ['./journey-form.page.scss'],\n})\nexport class JourneyFormPage implements OnInit {\n  loading = false;\n  form: FormGroup;\n  searching = true;\n  locationExists = false;\n  searchInputFormControl = new FormControl();\n  locations: Location[] = [];\n  filteredLocations: Location[] = [];\n  location: Location;\n  results: any;\n  hasNewOrder = false;\n  defaultLat = -27.4862341;\n  defaultLng = -58.8624276;\n\n  constructor(private formBuilder: FormBuilder,\n              private ngZone: NgZone,\n              private orderService: OrderService,\n              private toastComponent: ToastComponent,\n              private loadingSpinnerComponent: LoadingSpinnerComponent,\n              private router: Router,\n              private geocodeService: GeocodeService,\n              private modalController: ModalController,\n              private locationService: LocationService) {\n    this.form = this.formBuilder.group({\n      location_name: ['', Validators.required],\n      address: ['', Validators.required],\n      city: ['Buenos Aires', Validators.required],\n      notes: [''],\n      opening_hours: [''],\n      phones: ['']\n    });\n  }\n\n  ngOnInit(): void {\n    // this.orderService.currentOrders.subscribe(updated => {\n    //   this.getLocations();\n    // });\n    this.searchInputFormControl.valueChanges.subscribe(val => {\n      this.form.controls.location_name.setValue(val);\n      this.form.controls.address.setValue(val);\n    });\n  }\n\n  getLocations() {\n    this.locationService.getLocations()\n      .subscribe((response: any) => {\n        this.locations = response.locations;\n      }, error => {\n        //\n      }, () => {\n        //\n      });\n  }\n\n  submit() {\n    if (!this.locationExists) {\n      this.geocodeAddress();\n    } else {\n      this.storeOrder();\n    }\n  }\n\n  storeOrder() {\n    const body = {\n      type: 'journey',\n      location_id: this.location.id,\n      notes: this.form.value.notes,\n      opening_hours: this.form.value.opening_hours,\n      phones: this.form.value.phones,\n    };\n    this.orderService.store(body)\n      .subscribe((response: any) => {\n          // this.orderService.setUpdatedOrders(true);\n          //\n          this.router.navigateByUrl('journey-list');\n        }, error => {\n          //\n        },\n        () => {\n          this.resetForm();\n          this.searchInputFormControl.setValue('');\n        });\n  }\n\n  geocodeAddress() {\n    const address = this.form.value.location_name + ', ' +\n      this.form.value.address + ', ' +\n      this.form.value.city;\n    const country = 'Argentina';\n    this.geocodeService.mapQuestGeocode(address, country).then((result: any) => {\n      this.showLocationMap(result.lat, result.lng);\n    }).catch(err => {\n      this.geocodeService.GMGeocodeAddress(address, country).then((result: any) => {\n        this.showLocationMap(result.lat, result.lng);\n      }).catch(error => {\n        this.showLocationMap(this.defaultLat, this.defaultLng);\n      });\n    });\n  }\n\n  async showLocationMap(lat: number, lng: number) {\n    const modal = await this.modalController.create({\n      component: LocationMapComponent,\n      cssClass: 'modal-show-location-map',\n      componentProps: {\n        lat,\n        lng\n      }\n    });\n    await modal.present();\n\n    modal.onDidDismiss().then(data => {\n      if (data.data && data.data.success) {\n        this.handleResults(data.data.lat, data.data.lng);\n      }\n    });\n  }\n\n  handleResults(lat, lng) {\n    let locality = '';\n    let administrativeAreaLevel1 = '';\n    let administrativeAreaLevel2 = '';\n\n    if (this.results.length > 0) {\n      this.results[0].address_components.map(addressComponent => {\n        addressComponent.types.map(type => {\n          if (type === 'locality') {\n            locality = addressComponent.long_name;\n          } else if (type === 'administrative_area_level_1') {\n            administrativeAreaLevel1 = addressComponent.long_name;\n          } else if (type === 'administrative_area_level_2') {\n            administrativeAreaLevel2 = addressComponent.long_name;\n          }\n        });\n      });\n    }\n\n    const body = {\n      type: 'journey',\n      name: this.form.value.location_name,\n      address: this.form.value.address,\n      city: this.form.value.city,\n      notes: this.form.value.notes,\n      opening_hours: this.form.value.opening_hours,\n      phones: this.form.value.phones,\n      locality,\n      administrative_area_level_1: administrativeAreaLevel1,\n      administrative_area_level_2: administrativeAreaLevel2,\n      lat,\n      lng\n    };\n    this.storeLocation(body);\n  }\n\n  storeLocation(body) {\n    this.locationService.storeLocation(body)\n      .subscribe((response: any) => {\n          this.hasNewOrder = true;\n          this.router.navigateByUrl('journey-list');\n        }, error => {\n          const message = error?.error?.custom_message || 'No se pudo registrar la dirección';\n          this.toastComponent.presentToast(message, 'middle', 3000);\n        },\n        () => {\n          //\n          this.resetForm();\n          this.searchInputFormControl.setValue('');\n        });\n  }\n\n  selectLocation(location: Location) {\n    this.locationExists = true;\n    this.location = location;\n    this.searching = false;\n    this.filteredLocations = [];\n    this.form.controls.location_name.setValue(location.name);\n    this.form.controls.location_name.disable();\n    this.form.controls.address.disable();\n    this.form.controls.address.setValue(location.address);\n    this.form.controls.address.disable();\n    this.form.controls.city.setValue(location.city);\n    this.form.controls.city.disable();\n\n    this.form.controls.notes.setValue(location.notes);\n    this.form.controls.opening_hours.setValue(location.opening_hours);\n    this.form.controls.phones.setValue(location.phones);\n  }\n\n  search(event) {\n    this.searching = true;\n    this.locationExists = false;\n    this.resetForm();\n    const keyword = event.detail.value.toLowerCase();\n    if (keyword === '') {\n      this.filteredLocations = [];\n    } else {\n      this.filteredLocations = this.locations.filter(location =>\n        location.name.toLowerCase().includes(keyword)\n        || location.full_address.toLowerCase().includes(keyword));\n    }\n    if (this.filteredLocations.length <= 0) {\n      this.searching = false;\n    }\n  }\n\n  clear() {\n    this.searching = false;\n    this.filteredLocations = [];\n  }\n\n  resetForm() {\n    this.form.controls.location_name.setValue(this.searchInputFormControl.value);\n    this.form.controls.address.setValue('');\n    this.form.controls.city.setValue('Corrientes');\n    this.form.controls.notes.setValue('');\n    this.form.controls.opening_hours.setValue('');\n    this.form.controls.phones.setValue('');\n\n    this.form.controls.location_name.enable();\n    this.form.controls.address.enable();\n    this.form.controls.city.enable();\n    this.form.controls.notes.enable();\n    this.form.controls.opening_hours.enable();\n    this.form.controls.phones.enable();\n  }\n\n  dismiss() {\n    this.modalController.dismiss({hasNewOrder: this.hasNewOrder});\n  }\n\n}\n","import {Injectable, NgZone} from '@angular/core';\nimport {environment} from '../../../environments/environment';\nimport {HttpClient} from '@angular/common/http';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class GeocodeService {\n  results: any;\n\n  constructor(private ngZone: NgZone,\n              private http: HttpClient) {\n  }\n\n  mapQuestGeocode(addressToGeocode, country): Promise<{lat: number; lng: number}> {\n    return new Promise((resolve, reject) => {\n      const address = `${addressToGeocode},${country}`;\n      this.geocodeMapQuestAddress(address)\n        .subscribe((response: any) => {\n          const data = response;\n          if (data.results && data.results.length > 0) {\n            if (data.results[0].locations && data.results[0].locations.length > 0) {\n              if (data.results[0].locations[0].latLng) {\n                const lat = data.results[0].locations[0].latLng.lat;\n                const lng = data.results[0].locations[0].latLng.lng;\n            resolve({lat, lng});\n          }\n            }\n          } else {\n            reject();\n          }\n        }, error => {\n          reject(error);\n        });\n    });\n  }\n\n  GMGeocodeAddress(addressToGeocode, country): Promise<{lat: number; lng: number}> {\n    return new Promise((resolve, reject) => {\n      const self = this;\n      const address = `${addressToGeocode},${country}`;\n      const geocoder = new google.maps.Geocoder();\n      // tslint:disable-next-line:only-arrow-functions\n      geocoder.geocode({address}, (results, status) => {\n        if (status === google.maps.GeocoderStatus.OK) {\n          self.ngZone.run(() => {\n            self.results = results;\n            const lat = results[0].geometry.location.lat();\n            const lng = results[0].geometry.location.lng();\n            resolve({lat, lng});\n          });\n        } else {\n          reject(status);\n          // alert('Geocode was not successful for the following reason: ' + status);\n          if (status === google.maps.GeocoderStatus.ZERO_RESULTS) {\n            // self.toastComponent.presentToast('El API de Google Maps no encontró resultados');\n          }\n        }\n      });\n    });\n  }\n\n  geocodeMapQuestAddress(address) {\n    const key = environment.mapquest.key;\n    const endpoint = 'http://www.mapquestapi.com/geocoding/v1/address';\n    const url = `${endpoint}?key=${key}&location=${address}&thumbMaps=false&boundingBox=-21.357261,-74.723118,-57.6807156,-41.57098356&maxResults=1`;\n    return this.http.get(`${url}`);\n  }\n}\n"]}