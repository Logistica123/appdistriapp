{"version":3,"sources":["./src/app/pages/maintenance/document-list/document-list-routing.module.ts","./src/app/services/v1/document.service.ts","./src/app/pages/maintenance/document-list/document-list.module.ts","./src/app/pages/maintenance/document-list/document-list.page.ts","./src/app/pages/maintenance/document-list/document-list.page.html"],"names":[],"mappings":"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","file":"pages-maintenance-document-list-document-list-module-es2015.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { DocumentListPage } from './document-list.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: DocumentListPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class DocumentListPageRoutingModule {}\n","import {Injectable} from '@angular/core';\nimport {environment} from '../../../environments/environment';\nimport {HttpClient} from '@angular/common/http';\nimport {BehaviorSubject, Observable} from 'rxjs';\nimport {UploadedDocument} from '../../interfaces/UploadedDocument';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DocumentService {\n  API_URL = environment.API_URL;\n  V1 = 'v1/app/';\n\n  private updatedDocuments$ = new BehaviorSubject<boolean>(false);\n\n  constructor(private http: HttpClient) {\n  }\n\n  getDocumentTypes() {\n    return this.http.get(`${this.API_URL}${this.V1}document-types`);\n  }\n\n  getDocumentsByDocumentType(documentType) {\n    return this.http.get(`${this.API_URL}${this.V1}document-types/${documentType}/documents`);\n  }\n\n  getUploadedDocuments() {\n    return this.http.get(`${this.API_URL}${this.V1}uploaded-documents`);\n  }\n\n  storeUploadedDocument(body) {\n    return this.http.post(`${this.API_URL}${this.V1}uploaded-documents`, body);\n  }\n\n  deleteUploadedDocument(uploadedDocument: UploadedDocument) {\n    return this.http.delete(`${this.API_URL}${this.V1}uploaded-documents/${uploadedDocument.id}`);\n  }\n\n  getUpdatedDocuments$(): Observable<boolean> {\n    return this.updatedDocuments$.asObservable();\n  }\n\n  setUpdatedDocuments$(updated: boolean) {\n    this.updatedDocuments$.next(updated);\n  }\n}\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {FormsModule} from '@angular/forms';\n\nimport {IonicModule} from '@ionic/angular';\n\nimport {DocumentListPageRoutingModule} from './document-list-routing.module';\n\nimport {DocumentListPage} from './document-list.page';\nimport {ComponentsModule} from '../../../components/components.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    DocumentListPageRoutingModule,\n    ComponentsModule\n  ],\n  declarations: [DocumentListPage]\n})\nexport class DocumentListPageModule {\n}\n","import {Component, OnDestroy, OnInit} from '@angular/core';\nimport {AlertController, ModalController} from '@ionic/angular';\nimport {Router} from '@angular/router';\nimport {DocumentService} from '../../../services/v1/document.service';\nimport {UploadedDocument} from '../../../interfaces/UploadedDocument';\nimport {DocumentFileImageDetailComponent} from '../../../components/modals/document-file-image-detail/document-file-image-detail.component';\nimport {DocumentFile} from '../../../interfaces/DocumentFile';\nimport {HttpUploadFileService} from '../../../services/utils/http-upload-file.service';\nimport {AuthService} from '../../../services/v1/auth.service';\nimport {ToastComponent} from '../../../components/toast/toast.component';\n\n@Component({\n  selector: 'app-document-list',\n  templateUrl: './document-list.page.html',\n  styleUrls: ['./document-list.page.scss'],\n})\nexport class DocumentListPage implements OnInit, OnDestroy {\n  uploadedDocuments: UploadedDocument[] = [];\n  loading = true;\n  authToken: string;\n  downloading = false;\n  submitting = false;\n  updatedDocumentsSubscription: any;\n\n  constructor(private router: Router,\n              private documentService: DocumentService,\n              private httpUploadFileService: HttpUploadFileService,\n              private authService: AuthService,\n              private alertController: AlertController,\n              private toastComponent: ToastComponent,\n              private modalController: ModalController) {\n  }\n\n  ngOnInit() {\n    this.authService.getAuthToken().then(authToken => {\n      this.authToken = authToken;\n    });\n\n    this.updatedDocumentsSubscription = this.documentService.getUpdatedDocuments$()\n      .subscribe(updated => {\n        this.getDocuments();\n      });\n  }\n\n  ngOnDestroy(): void {\n    if (this.updatedDocumentsSubscription) {\n      this.updatedDocumentsSubscription.unsubscribe();\n    }\n  }\n\n  async addDocument() {\n    this.router.navigateByUrl('document-form');\n  }\n\n  getDocuments() {\n    this.loading = true;\n    this.documentService.getUploadedDocuments()\n      .subscribe((response: any) => {\n        this.uploadedDocuments = response.uploaded_documents;\n      }, error => {\n        this.loading = false;\n        //\n      }, () => {\n        this.loading = false;\n        //\n      });\n  }\n\n  downloadFile(documentFile: DocumentFile) {\n    this.downloading = true;\n    console.log(documentFile);\n    this.httpUploadFileService.downloadFile(\n      `document-files/${documentFile.id}/download`,\n      {}, this.authToken,\n      documentFile.filename,\n      documentFile.mime\n    )\n      .then(() => {\n        this.downloading = false;\n      }).catch(err => {\n      this.downloading = false;\n      this.toastComponent.presentToast(\n        `No se pudo descargar el archivo. Intente nuevamente`,\n        'middle',\n        3000,\n      );\n    });\n  }\n\n  async viewDetail(uploadedDocument: UploadedDocument) {\n    const modal = await this.modalController.create({\n      component: DocumentFileImageDetailComponent,\n      cssClass: 'modal-document-image-view',\n      componentProps: {\n        documentFiles: uploadedDocument.document_files\n      }\n    });\n    await modal.present();\n  }\n\n  async presentDeleteDocumentAlertConfirm(uploadedDocument: UploadedDocument) {\n    const alert = await this.alertController.create({\n      header: '¿Desea eliminar el registro?',\n      buttons: [\n        {\n          text: 'No',\n          role: 'cancel',\n          cssClass: 'secondary',\n          handler: () => {\n            //\n          }\n        }, {\n          text: 'Sí',\n          handler: () => {\n            this.deleteUploadedDocument(uploadedDocument);\n          }\n        }\n      ]\n    });\n\n    await alert.present();\n  }\n\n  deleteUploadedDocument(uploadedDocument: UploadedDocument) {\n    this.submitting = true;\n    this.documentService.deleteUploadedDocument(uploadedDocument)\n      .subscribe((response: any) => {\n        this.uploadedDocuments = this.uploadedDocuments.filter(item => item.id !== uploadedDocument.id);\n        this.submitting = false;\n      }, error => {\n        this.submitting = false;\n      });\n  }\n\n  doRefresh(event) {\n    console.log('Begin async operation');\n\n    setTimeout(() => {\n      console.log('Async operation has ended');\n      this.getDocuments();\n      event.target.complete();\n    }, 2000);\n  }\n\n}\n","<ion-header>\n  <ion-toolbar>\n    <ion-buttons slot=\"start\">\n      <ion-menu-button autoHide=\"false\"></ion-menu-button>\n    </ion-buttons>\n    <ion-title>MANTENIMIENTO</ion-title>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content class=\"ion-padding\">\n  <ion-progress-bar class=\"ion-margin-top\"\n                    type=\"indeterminate\"\n                    *ngIf=\"loading || submitting\">\n  </ion-progress-bar>\n\n  <div class=\"ion-text-center ion-padding-bottom\">\n    <ion-button class=\"custom-button\" (click)=\"addDocument()\">\n      AGREGAR\n    </ion-button>\n  </div>\n\n  <ion-refresher slot=\"fixed\" (ionRefresh)=\"doRefresh($event)\">\n    <ion-refresher-content></ion-refresher-content>\n  </ion-refresher>\n\n  <p class=\"ion-padding ion-text-center\" *ngIf=\"!loading && uploadedDocuments.length <= 0\">\n    <b>No tienes ningún documento guardado</b>\n  </p>\n\n  <!--  <div *ngIf=\"!loading && uploadedDocuments.length > 0\">-->\n  <!--    <ion-list>-->\n  <!--      <ion-item *ngFor=\"let uploadedDocument of uploadedDocuments\" detail (click)=\"viewDetail(uploadedDocument)\">-->\n  <!--        <ion-label text-wrap>-->\n  <!--          <p>{{uploadedDocument.document.name}} - ({{uploadedDocument.document.document_type.type}})</p>-->\n  <!--          <p>{{uploadedDocument.created_at | date: 'dd/M/yyyy'}}</p>-->\n  <!--        </ion-label>-->\n  <!--      </ion-item>-->\n  <!--    </ion-list>-->\n  <!--  </div>-->\n\n  <ion-item-sliding *ngFor=\"let uploadedDocument of uploadedDocuments; let i = index\"\n                    class=\"ion-margin-bottom\">\n    <ion-item lines=\"none\">\n      <div class=\"uploaded-document\">\n        <p class=\"ion-no-margin\">\n          {{uploadedDocument.document.name}} - ({{uploadedDocument.document.document_type.type}})\n        </p>\n        <p class=\"ion-no-margin\">\n          {{uploadedDocument.created_at | date: 'dd/M/yyyy'}}\n        </p>\n        <ion-grid>\n          <ion-row *ngFor=\"let documentFile of uploadedDocument.document_files\">\n            <ion-col size=\"10\">\n              {{documentFile.filename}}\n            </ion-col>\n            <ion-col size=\"2\" class=\"ion-align-self-center ion-text-center\">\n              <ion-icon color=\"primary\" name=\"download\" class=\"font-15em\"\n                        (click)=\"downloadFile(documentFile)\">\n              </ion-icon>\n              <ion-progress-bar *ngIf=\"downloading\" type=\"indeterminate\"></ion-progress-bar>\n            </ion-col>\n          </ion-row>\n        </ion-grid>\n      </div>\n    </ion-item>\n    <ion-item-options>\n      <ion-item-option color=\"light\" (click)=\"presentDeleteDocumentAlertConfirm(uploadedDocument)\">\n        <ion-icon slot=\"end\" name=\"trash\"></ion-icon>\n        Eliminar\n      </ion-item-option>\n    </ion-item-options>\n  </ion-item-sliding>\n\n\n</ion-content>\n"],"sourceRoot":"webpack:///"}