{"version":3,"sources":["webpack:///src/app/pages/journeys/journey-list/journey-list.page.html","webpack:///src/app/pages/journeys/journey-list/journey-list.page.ts","webpack:///src/app/pages/journeys/journey-list/journey-list-routing.module.ts","webpack:///src/app/pages/journeys/journey-list/journey-list.module.ts"],"names":["JourneyListPage","modalController","locationService","alertController","loadingController","geolocation","toastComponent","geolocationService","driverService","router","orderService","orders","dateFC","date","Date","loading","optimizingOrders","ngOnInit","driverSubscription","getDriver$","subscribe","driver","getProfile","response","ngAfterViewInit","setValue","toISOString","getOrdersByDate","ngOnDestroy","unsubscribe","doReorder","ev","swapArrayElement","detail","from","to","complete","temp","addLocation","create","component","modal","present","onDidDismiss","data","hasNewOrder","viewOrderDetail","order","componentProps","onWillDismiss","success","console","log","day","getDate","month","getMonth","year","getFullYear","error","onDateChange","event","value","showMap","length","message","buttons","alert","checkDriverPosition","getDriverPosition","driverPosition","coords","latitude","longitude","getCurrentPosition","then","presentToast","checkUndeliveredOrders","undeliveredOrders","filter","status","optimizeOrders","originLat","start_lat","originLng","start_lng","undefined","lat","Number","lng","body","orders_ids","map","id","presentDeleteOrderAlertConfirm","header","text","role","cssClass","handler","deleteOrder","doRefresh","setTimeout","target","routes","path","JourneyListPageRoutingModule","forChild","JourneyListPageModule"],"mappings":"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","file":"pages-journeys-journey-list-journey-list-module-es5.js","sourcesContent":["<ion-header>\n  <ion-toolbar>\n    <ion-buttons slot=\"start\">\n      <ion-menu-button autoHide=\"false\"></ion-menu-button>\n    </ion-buttons>\n    <ion-title>VIAJES</ion-title>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content>\n  <ion-item lines=\"none\" class=\"custom-date-item \">\n    <ion-datetime [formControl]=\"dateFC\"\n                  (ionChange)=\"onDateChange($event)\"\n                  displayFormat=\"DD MMMM YYYY\"\n                  placeholder=\"Seleccione fecha\"\n                  doneText=\"ok\"\n                  cancelText=\"cancelar\"\n                  monthNames=\"enero, febrero, marzo, abril, mayo, junio, julio, agosto, septiembre, octubre, noviembre, diciembre\"\n                  monthShortNames=\"ene, feb, mar, abr, may, jun, jul, ago, sep, oct, nov, dic\"\n                  dayNames=\"domingo, lunes, martes, miércoles, jueves, viernes, sábado, domingo\"\n                  dayShortNames=\"dom, lun, mar, mié, jue, vie, sáb, dom\">\n    </ion-datetime>\n  </ion-item>\n\n  <div class=\"ion-text-center ion-padding-bottom\">\n    <ion-button class=\"custom-button\" (click)=\"addLocation()\">\n      AGREGAR\n    </ion-button>\n  </div>\n\n  <ion-refresher slot=\"fixed\" (ionRefresh)=\"doRefresh($event)\">\n    <ion-refresher-content></ion-refresher-content>\n  </ion-refresher>\n\n  <p *ngIf=\"!loading && orders.length <= 0\" class=\"ion-padding ion-text-center\">\n    <b>No tienes viajes pendientes </b>\n  </p>\n\n  <div class=\"ion-padding ion-text-center\" *ngIf=\"loading\">\n    <ion-progress-bar type=\"indeterminate\"></ion-progress-bar>\n  </div>\n\n  <ion-reorder-group (ionItemReorder)=\"doReorder($event)\" disabled=\"false\">\n    <ion-item-sliding *ngFor=\"let order of orders; let i=index\">\n      <ion-item (click)=\"viewOrderDetail(order)\">\n        <ion-grid>\n          <ion-row>\n            <ion-col size=\"1\">\n              <ion-icon name=\"pin\" color=\"dark\"></ion-icon>\n            </ion-col>\n            <ion-col size=\"9\">\n              {{order.location.name | uppercase}}\n            </ion-col>\n            <ion-col size=\"2\">\n              <ion-badge color=\"primary\">{{i + 1}}</ion-badge>\n            </ion-col>\n          </ion-row>\n          <ion-row>\n            <ion-col>\n              <ion-label class=\"ion-text-wrap\">\n                {{order.location.address | uppercase}}. {{order.location.city | uppercase}}\n              </ion-label>\n            </ion-col>\n          </ion-row>\n          <ion-row>\n            <ion-col>\n              <ion-badge\n                [color]=\"order.status === 'delivered' ? 'primary' : order.status === 'skipped' ? 'warning' : 'danger'\">\n                {{order.status_es | uppercase}}\n              </ion-badge>\n            </ion-col>\n          </ion-row>\n        </ion-grid>\n        <ion-reorder slot=\"end\"></ion-reorder>\n      </ion-item>\n\n      <ion-item-options>\n        <ion-item-option color=\"light\" (click)=\"presentDeleteOrderAlertConfirm(order)\">\n          <ion-icon slot=\"end\" name=\"trash\"></ion-icon>\n          Eliminar\n        </ion-item-option>\n      </ion-item-options>\n    </ion-item-sliding>\n  </ion-reorder-group>\n</ion-content>\n\n<ion-footer>\n  <ion-toolbar>\n    <ion-tabs>\n      <ion-tab-bar slot=\"bottom\" color=\"light\">\n        <ion-tab-button (click)=\"showMap()\">\n          <ion-icon name=\"navigate-circle\"></ion-icon>\n          <ion-label>Comenzar</ion-label>\n        </ion-tab-button>\n\n        <ion-tab-button (click)=\"optimizeOrders()\">\n          <ion-icon name=\"filter\" *ngIf=\"!optimizingOrders\"></ion-icon>\n          <ion-spinner name=\"bubbles\" *ngIf=\"optimizingOrders\"></ion-spinner>\n          <ion-label *ngIf=\"!optimizingOrders\">Optimizar</ion-label>\n          <ion-label *ngIf=\"optimizingOrders\">Optimizando...</ion-label>\n        </ion-tab-button>\n      </ion-tab-bar>\n    </ion-tabs>\n  </ion-toolbar>\n</ion-footer>\n","import {AfterViewInit, Component, OnDestroy, OnInit, ViewChild} from '@angular/core';\nimport {FormControl} from '@angular/forms';\nimport {Router} from '@angular/router';\nimport {Geoposition} from '@ionic-native/geolocation';\nimport {Geolocation} from '@ionic-native/geolocation/ngx';\nimport {AlertController, IonReorderGroup, LoadingController, ModalController} from '@ionic/angular';\nimport {Subscription} from 'rxjs';\nimport {ToastComponent} from '../../../components/toast/toast.component';\nimport {DeliveryMapPage} from '../../delivery-map/delivery-map.page';\nimport {JourneyDetailPage} from '../journey-detail/journey-detail.page';\nimport {JourneyFormPage} from '../journey-form/journey-form.page';\nimport {Driver} from '../../../interfaces/Driver';\nimport {Order} from '../../../interfaces/Order';\nimport {DriverService} from '../../../services/v1/driver.service';\nimport {GeolocationService} from '../../../services/v1/geolocation.service';\nimport {LocationService} from '../../../services/v1/location.service';\nimport {OrderService} from '../../../services/v1/order.service';\n\n@Component({\n  selector: 'app-journey-list',\n  templateUrl: './journey-list.page.html',\n  styleUrls: ['./journey-list.page.scss'],\n})\nexport class JourneyListPage implements OnInit, AfterViewInit, OnDestroy {\n  orders: Order[] = [];\n  dateFC = new FormControl();\n  date = new Date();\n  driverPosition: Geoposition;\n  driver: Driver;\n  @ViewChild(IonReorderGroup, {static: true}) reorderGroup: IonReorderGroup;\n  loading = true;\n  optimizingOrders = false;\n  driverSubscription: Subscription;\n\n  constructor(private modalController: ModalController,\n              private locationService: LocationService,\n              private alertController: AlertController,\n              private loadingController: LoadingController,\n              private geolocation: Geolocation,\n              private toastComponent: ToastComponent,\n              private geolocationService: GeolocationService,\n              private driverService: DriverService,\n              private router: Router,\n              private orderService: OrderService) {\n  }\n\n  ngOnInit() {\n    this.driverSubscription = this.driverService.getDriver$()\n      .subscribe(driver => {\n        if (driver) {\n          this.driver = driver;\n        } else {\n          this.driverService.getProfile().subscribe((response: any) => {\n            this.driver = response.driver;\n          });\n        }\n      });\n  }\n\n  ngAfterViewInit() {\n    this.date = new Date();\n    this.dateFC.setValue(this.date.toISOString());\n    this.getOrdersByDate();\n  }\n\n  ngOnDestroy() {\n    if (this.driverSubscription) {\n      this.driverSubscription.unsubscribe();\n    }\n  }\n\n  doReorder(ev: any) {\n    this.swapArrayElement(ev.detail.from, ev.detail.to);\n    ev.detail.complete();\n  }\n\n  swapArrayElement(from: number, to: number) {\n    const temp = this.orders[from];\n    this.orders[from] = this.orders[to];\n    this.orders[to] = temp;\n  }\n\n  async addLocation() {\n    const modal = await this.modalController.create({\n      component: JourneyFormPage\n    });\n    await modal.present();\n    const {data} = await modal.onDidDismiss();\n    if (data?.hasNewOrder) {\n      this.getOrdersByDate();\n    }\n  }\n\n  async viewOrderDetail(order: Order) {\n    const modal = await this.modalController.create({\n      component: JourneyDetailPage,\n      componentProps: {order},\n    });\n    await modal.present();\n    const {data} = await modal.onWillDismiss();\n    if (data?.success) {\n      //\n    }\n  }\n\n  getOrdersByDate() {\n    console.log('getting orders by date...');\n    this.orders = [];\n    this.loading = true;\n    const day = this.date.getDate();\n    const month = this.date.getMonth() + 1;\n    const year = this.date.getFullYear();\n    this.orderService.getOrdersByDate('journey', day, month, year)\n      .subscribe((response: any) => {\n        this.orders = response.orders;\n        this.loading = false;\n      }, error => {\n        this.loading = false;\n      });\n  }\n\n  onDateChange(event) {\n    this.date = new Date(event.detail.value);\n    this.getOrdersByDate();\n  }\n\n  async showMap() {\n    if (this.orders.length <= 0) {\n      const alert = await this.alertController.create({\n        message: 'No tienes paquetes pendientes por entregar',\n        buttons: ['OK']\n      });\n      await alert.present();\n    } else {\n      const modal = await this.modalController.create({\n        component: DeliveryMapPage,\n        componentProps: {orders: this.orders}\n      });\n\n      await modal.present();\n\n      const {data} = await modal.onDidDismiss();\n      this.getOrdersByDate();\n    }\n  }\n\n  checkDriverPosition() {\n    console.log(this.geolocationService.getDriverPosition());\n    this.driverPosition = this.geolocationService.getDriverPosition();\n    if (!(this.driverPosition?.coords?.latitude && this.driverPosition?.coords?.longitude)) {\n      this.geolocationService.getCurrentPosition().then((driverPosition: any) => {\n        this.driverPosition = driverPosition;\n\n        if (!(this.driverPosition?.coords?.latitude && this.driverPosition?.coords?.longitude)) {\n          this.toastComponent.presentToast(\n            `No se pudo obtener ubicación actual. Por favor concede los permisos\n          para que la aplicación pueda utilizar el GPS de su dispositivo móvil`,\n            'middle',\n            3500\n          );\n          return false;\n        } else {\n          return true;\n        }\n      });\n    } else {\n      return true;\n    }\n  }\n\n  checkUndeliveredOrders() {\n    const undeliveredOrders = this.orders.filter(order => order.status !== 'delivered');\n\n    if (undeliveredOrders.length <= 0) {\n      this.toastComponent.presentToast(\n        `No hay paquetes pendientes por entregar`,\n        'middle',\n        3500\n      );\n    }\n\n    return undeliveredOrders;\n  }\n\n\n  async optimizeOrders() {\n    const undeliveredOrders = this.checkUndeliveredOrders();\n\n    let originLat = this.driver?.start_lat;\n    let originLng = this.driver?.start_lng;\n\n    if ((originLat === undefined || originLat === null) || (originLng === undefined || originLng === null)) {\n      if (!this.checkDriverPosition()) {\n        return;\n      }\n      originLat = this.driverPosition?.coords?.latitude;\n      originLng = this.driverPosition?.coords?.longitude;\n    }\n\n    if (undeliveredOrders.length > 0 && originLat !== undefined && originLat !== null && originLng !== undefined && originLng !== null) {\n      const lat = Number(originLat);\n      const lng = Number(originLng);\n      const body = {\n        lat,\n        lng,\n        orders_ids: undeliveredOrders.map(order => order.id),\n      };\n      console.log(body);\n      this.optimizingOrders = true;\n      this.orderService.optimizeOrders(body)\n        .subscribe((response: any) => {\n          this.orders = response.orders;\n          this.optimizingOrders = false;\n          this.toastComponent.presentToast(\n            `Ruta optimizada`,\n            'bottom',\n            3500\n          );\n        }, error => {\n          this.optimizingOrders = false;\n        });\n    } else if (undeliveredOrders.length > 0) {\n      this.toastComponent.presentToast(\n        'No se pudo determinar tu punto de partida. Configúralo en tu perfil o habilita el GPS.',\n        'middle',\n        3500\n      );\n    }\n  }\n\n  async presentDeleteOrderAlertConfirm(order: Order) {\n    const alert = await this.alertController.create({\n      header: '¿Desea eliminar esta ubicación de su hoja de ruta?',\n      buttons: [\n        {\n          text: 'No',\n          role: 'cancel',\n          cssClass: 'secondary',\n          handler: () => {\n            //\n          }\n        }, {\n          text: 'Sí',\n          handler: () => {\n            this.deleteOrder(order);\n          }\n        }\n      ]\n    });\n\n    await alert.present();\n  }\n\n  deleteOrder(order: Order) {\n    this.orderService.deleteOrder(order)\n      .subscribe((response: any) => {\n        this.getOrdersByDate();\n      });\n  }\n\n  doRefresh(event) {\n    console.log('Begin async operation');\n\n    setTimeout(() => {\n      console.log('Async operation has ended');\n      this.getOrdersByDate();\n      event.target.complete();\n    }, 2000);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { JourneyListPage } from './journey-list.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: JourneyListPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class JourneyListPageRoutingModule {}\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\n\nimport {IonicModule} from '@ionic/angular';\n\nimport {JourneyListPageRoutingModule} from './journey-list-routing.module';\n\nimport {JourneyListPage} from './journey-list.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    JourneyListPageRoutingModule\n  ],\n  declarations: [JourneyListPage]\n})\nexport class JourneyListPageModule {\n}\n"]}