{"version":3,"sources":["webpack:///src/app/pages/profile/profile-data/profile-data.module.ts","webpack:///src/app/pages/profile/profile-data/profile-data-routing.module.ts","webpack:///src/app/pages/profile/profile-data/profile-data.page.html","webpack:///src/app/pages/profile/profile-data/profile-data.page.ts"],"names":["ProfileDataPageModule","routes","path","component","ProfileDataPageRoutingModule","forChild","ProfileDataPage","driverService","storage","formBuilder","domSanitizer","http","alertController","imagePickerService","loadingSpinnerComponent","toastComponent","modalController","files","filesSrc","filenames","loading","V1","ngOnInit","getProfile","get","then","authToken","subscribe","response","driver","setDriver$","distance","duration","has_profile_img","getProfileImage","error","blob","objectURL","URL","createObjectURL","profileImg","bypassSecurityTrustUrl","updateProfile","create","componentProps","modal","present","onDidDismiss","result","data","success","updatePassword","cssClass","pickImage","imagePickerOptions","maximumImagesCount","quality","pickImages","err","presentToast","uploadFile","presentLoadingSpinner","API_URL","uri","encodeURI","headers","Authorization","dismissLoadingSpinner","JSON","stringify","onToggleChange","ev","console","log","detail","checked","presentAlertConfirm","updateDriverContractor","header","message","buttons","text","role","handler","blah","alert","hasContractor","body","has_contractor","updateContractor","doRefresh","event","setTimeout","target","complete"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;UAmBaA,qB;;;;;yBAAAA,qB;AAAqB,O;;;cAArBA;;;kBATF,CACP,4DADO,EAEP,0DAFO,EAGP,kEAHO,EAIP,0DAJO,EAKP,yFALO,C;;;;4HASEA,qB,EAAqB;AAAA,yBAFjB,kEAEiB;AAFF,oBAN5B,4DAM4B,EAL5B,0DAK4B,EAJ5B,kEAI4B,EAH5B,0DAG4B,EAF5B,yFAE4B;AAEE,S;AAJF,O;;;;;;;;;;;;;;;;;ACfhC;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AAIA,UAAMC,MAAM,GAAW,CACrB;AACEC,YAAI,EAAE,EADR;AAEEC,iBAAS,EAAE;AAFb,OADqB,CAAvB;;UAWaC,4B;;;;;yBAAAA,4B;AAA4B,O;;;cAA5BA;;;kBAHF,CAAC,6DAAaC,QAAb,CAAsBJ,MAAtB,CAAD,C,EACC,4D;;;;4HAECG,4B,EAA4B;AAAA;AAAA,oBAF7B,4DAE6B;AAAA,S;AAFjB,O;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACbtB;;;;;;;;AAWI;;AAC6D;AAAA;;AAAA;;AAAA;AAAA;;AAD7D;;;;;;;;AAGA;;AACiC;AAAA;;AAAA;;AAAA;AAAA;;AADjC;;;;;;AAAK;;;;;;;;AAGL;;AAC0E;AAAA;;AAAA;;AAAA;AAAA;;AAD1E;;;;;;AAAK;;;;;;;;AAIP;;AACE;;AAAwC;AAAA;;AAAA;;AAAA;AAAA;;AACtC;;AACF;;AACF;;;;;;;;AAhBF;;AACE;;AACE;;AAGA;;AAGA;;AAEF;;AAEA;;AAMA;;AACE;;AAAmC;AAAA;;AAAA;;AAAA;AAAA;;AACjC;;AACF;;AACF;;AAEA;;AACE;;AAAmC;AAAA;;AAAA;;AAAA;AAAA;;AACjC;;AACF;;AACF;;AAEA;;AACE;;AACE;;AACE;;AACF;;AACA;;AACE;;AACY;AAAA;;AAAA;;AAAA;AAAA;;AAEZ;;AACF;;AACA;;AACE;;AACF;;AACF;;AACF;;AAEA;;AACE;;AACE;;AACE;;AACF;;AACA;;AACE;;AACF;;AACF;;AAEA;;AACE;;AACE;;AACF;;AACA;;AACE;;AACF;;AACF;;AAEA;;AACE;;AACE;;AACF;;AACA;;AACE;;AACF;;AACF;;AAEA;;AACE;;AACE;;AACF;;AACA;;AACE;;AACF;;AACF;;AAEA;;AACE;;AACE;;AACF;;AACA;;AACE;;AACF;;AACF;;AAEA;;AACE;;AACE;;AACF;;AACA;;AACE;;AACF;;AACF;;AAEA;;AACE;;AACE;;AACF;;AACA;;AACE;;AACF;;AACF;;AAEA;;AACE;;AACE;;AACF;;AACA;;AACE;;AACF;;AACF;;AAEA;;AACE;;AACE;;AACF;;AACA;;AACE;;AACF;;AACF;;AAEA;;AACE;;AACE;;AACF;;AACA;;AACE;;AACF;;AACF;;AACF;;AAEA;;AACE;;AACE;;AAA0B;;AAAgB;;AAC1C;;AAAyB;;AAAkB;;AAC7C;;AACF;;AAEA;;AACE;;AACE;;AAA0B;;AAAe;;AACzC;;AAAyB;;AAAe;;AAC1C;;AACF;;AACF;;;;;;AArJU;;AAAA;;AAGA;;AAAA;;AAGA;;AAAA;;AAGiC;;AAAA;;AA0BvB;;AAAA;;AAeZ;;AAAA;;AASA;;AAAA;;AASA;;AAAA;;AASA;;AAAA;;AASA;;AAAA;;AASA;;AAAA;;AASA;;AAAA;;AASA;;AAAA;;AASA;;AAAA;;AASA;;AAAA;;AAOwB;;AAAA;;AAOA;;AAAA;;;;UCzIrBE,e;AAYX,iCAAoBC,aAApB,EACoBC,OADpB,EAEoBC,WAFpB,EAGoBC,YAHpB,EAIoBC,IAJpB,EAKoBC,eALpB,EAMoBC,kBANpB,EAOoBC,uBAPpB,EAQoBC,cARpB,EASoBC,eATpB,EASsD;AAAA;;A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","file":"profile-data-profile-data-module-es5.js","sourcesContent":["import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\n\nimport {IonicModule} from '@ionic/angular';\n\nimport {ProfileDataPageRoutingModule} from './profile-data-routing.module';\n\nimport {ProfileDataPage} from './profile-data.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    ProfileDataPageRoutingModule\n  ],\n  declarations: [ProfileDataPage]\n})\nexport class ProfileDataPageModule {\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ProfileDataPage } from './profile-data.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ProfileDataPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ProfileDataPageRoutingModule {}\n","<ion-content class=\"ion-text-center\">\n  <ion-progress-bar class=\"ion-margin-top\"\n                    type=\"indeterminate\"\n                    *ngIf=\"loading\">\n  </ion-progress-bar>\n\n  <ion-refresher slot=\"fixed\" (ionRefresh)=\"doRefresh($event)\">\n    <ion-refresher-content></ion-refresher-content>\n  </ion-refresher>\n\n  <div *ngIf=\"driver\">\n    <div class=\"ion-margin-top\">\n      <img src=\"assets/images/default_profile_img.png\" alt=\"profile_img\"\n           *ngIf=\"filesSrc.length <=0 && !driver?.has_profile_img\" (click)=\"pickImage()\">\n\n      <img [src]=\"filesSrc\" alt=\"profile_img\"\n           *ngIf=\"filesSrc.length > 0\" (click)=\"pickImage()\">\n\n      <img [src]=\"profileImg\" alt=\"profile_img\"\n           *ngIf=\"filesSrc.length <=0 && driver?.has_profile_img && profileImg\" (click)=\"pickImage()\">\n    </div>\n\n    <div class=\"ion-text-center ion-margin\" *ngIf=\"filesSrc.length > 0\">\n      <div class=\"update-profile-image small\" (click)=\"uploadFile()\">\n        Guardar nueva imagen de perfil\n      </div>\n    </div>\n\n    <div class=\"ion-text-center ion-margin\">\n      <div class=\"update-password small\" (click)=\"updatePassword()\">\n        Cambiar contraseña\n      </div>\n    </div>\n\n    <div class=\"ion-text-center ion-margin\">\n      <div class=\"update-password small\" (click)=\"updateProfile()\">\n        Editar información\n      </div>\n    </div>\n\n    <ion-grid class=\"contractor-toggle\">\n      <ion-row>\n        <ion-col size=\"4\" class=\"ion-align-self-center\">\n          Terceros\n        </ion-col>\n        <ion-col size=\"4\">\n          <ion-toggle color=\"light\"\n                      (ionChange)=\"onToggleChange($event)\"\n                      [checked]=\"driver?.contractor === 'logistic_company'\">\n          </ion-toggle>\n        </ion-col>\n        <ion-col size=\"4\" class=\"ion-align-self-center\">\n          Empresa logística\n        </ion-col>\n      </ion-row>\n    </ion-grid>\n\n    <ion-grid class=\"profile-data\">\n      <ion-row>\n        <ion-col size=\"6\">\n          Ciudad\n        </ion-col>\n        <ion-col size=\"6\">\n          {{driver?.city}}\n        </ion-col>\n      </ion-row>\n\n      <ion-row>\n        <ion-col size=\"6\">\n          Teléfono\n        </ion-col>\n        <ion-col size=\"6\">\n          {{driver?.phone_number}}\n        </ion-col>\n      </ion-row>\n\n      <ion-row>\n        <ion-col size=\"6\">\n          Empresa\n        </ion-col>\n        <ion-col size=\"6\">\n          {{driver?.company}}\n        </ion-col>\n      </ion-row>\n\n      <ion-row>\n        <ion-col size=\"6\">\n          Punto de partida\n        </ion-col>\n        <ion-col size=\"6\">\n          {{driver?.start_address || 'No configurado'}}\n        </ion-col>\n      </ion-row>\n\n      <ion-row>\n        <ion-col size=\"6\">\n          Valor por hora\n        </ion-col>\n        <ion-col size=\"6\">\n          {{driver?.cost_per_hour}}\n        </ion-col>\n      </ion-row>\n\n      <ion-row>\n        <ion-col size=\"6\">\n          Valor por kilómetro\n        </ion-col>\n        <ion-col size=\"6\">\n          {{driver?.cost_per_km}}\n        </ion-col>\n      </ion-row>\n\n      <ion-row>\n        <ion-col size=\"6\">\n          Marca unidad\n        </ion-col>\n        <ion-col size=\"6\">\n          {{driver?.car_make}}\n        </ion-col>\n      </ion-row>\n\n      <ion-row>\n        <ion-col size=\"6\">\n          Modelo unidad\n        </ion-col>\n        <ion-col size=\"6\">\n          {{driver?.car_model}}\n        </ion-col>\n      </ion-row>\n\n      <ion-row>\n        <ion-col size=\"6\">\n          Tonelaje\n        </ion-col>\n        <ion-col size=\"6\">\n          {{driver?.tonnage}}\n        </ion-col>\n      </ion-row>\n\n      <ion-row>\n        <ion-col size=\"6\">\n          Matrícula\n        </ion-col>\n        <ion-col size=\"6\">\n          {{driver?.license_plate}}\n        </ion-col>\n      </ion-row>\n    </ion-grid>\n\n    <ion-item>\n      <ion-label>\n        <p class=\"distance-value\">{{distance}} km.</p>\n        <p class=\"distance-text\">Distancia cubierta</p>\n      </ion-label>\n    </ion-item>\n\n    <ion-item>\n      <ion-label>\n        <p class=\"distance-value\">{{duration}} h.</p>\n        <p class=\"distance-text\">Tiempo cubierto</p>\n      </ion-label>\n    </ion-item>\n  </div>\n</ion-content>\n","import {Component, OnInit} from '@angular/core';\nimport {Driver} from '../../../interfaces/Driver';\nimport {FormBuilder} from '@angular/forms';\nimport {DriverService} from '../../../services/v1/driver.service';\nimport {Storage} from '@ionic/storage';\nimport {DomSanitizer} from '@angular/platform-browser';\nimport {HTTP} from '@ionic-native/http/ngx';\nimport {ImagePickerService} from '../../../services/utils/image-picker.service';\nimport {LoadingSpinnerComponent} from '../../../components/loading-spinner/loading-spinner.component';\nimport {ToastComponent} from '../../../components/toast/toast.component';\nimport {AlertController, ModalController} from '@ionic/angular';\nimport {UpdatePasswordComponent} from '../../../components/modals/update-password/update-password.component';\nimport {ImagePickerOptions} from '@ionic-native/image-picker';\nimport {environment} from '../../../../environments/environment';\nimport {ProfileFormPage} from '../profile-form/profile-form.page';\n\n@Component({\n  selector: 'app-profile-data',\n  templateUrl: './profile-data.page.html',\n  styleUrls: ['./profile-data.page.scss'],\n})\nexport class ProfileDataPage implements OnInit {\n  driver: Driver;\n  distance: string;\n  duration: string;\n  files: any = [];\n  filesSrc: any = [];\n  filenames: string[] = [];\n  authToken: string;\n  profileImg: any;\n  loading = false;\n  V1 = 'v1/app/';\n\n  constructor(private driverService: DriverService,\n              private storage: Storage,\n              private formBuilder: FormBuilder,\n              private domSanitizer: DomSanitizer,\n              private http: HTTP,\n              private alertController: AlertController,\n              private imagePickerService: ImagePickerService,\n              private loadingSpinnerComponent: LoadingSpinnerComponent,\n              private toastComponent: ToastComponent,\n              private modalController: ModalController) {\n    //\n  }\n\n  ngOnInit() {\n    this.getProfile();\n    this.storage.get('auth_token').then(authToken => {\n      this.authToken = authToken;\n    });\n  }\n\n  getProfile() {\n    this.loading = true;\n    this.driverService.getProfile()\n      .subscribe((response: any) => {\n        this.driver = response.driver;\n        this.driverService.setDriver$(this.driver);\n        this.distance = response.distance;\n        this.duration = response.duration;\n        if (this.driver.has_profile_img) {\n          this.getProfileImage();\n        }\n      }, error => {\n        this.loading = false;\n      }, () => {\n        this.loading = false;\n      });\n  }\n\n  getProfileImage() {\n    this.driverService.getProfileImage()\n      .subscribe((blob: any) => {\n        const objectURL = URL.createObjectURL(blob);\n        this.profileImg = this.domSanitizer.bypassSecurityTrustUrl(objectURL);\n      });\n  }\n\n  async updateProfile() {\n    const modal = await this.modalController.create({\n      component: ProfileFormPage,\n      componentProps: {driver: this.driver}\n    });\n    await modal.present();\n\n    modal.onDidDismiss().then(result => {\n      if (result?.data?.success) {\n        this.getProfile();\n      }\n    });\n  }\n\n  async updatePassword() {\n    const modal = await this.modalController.create({\n      component: UpdatePasswordComponent,\n      cssClass: 'modal-update-password'\n    });\n    await modal.present();\n\n    modal.onDidDismiss().then(result => {\n      if (result && result.data && result.data.success) {\n        this.getProfile();\n      }\n    });\n  }\n\n  pickImage() {\n    const imagePickerOptions: ImagePickerOptions = {\n      maximumImagesCount: 1,\n      quality: 70\n    };\n    this.imagePickerService.pickImages(imagePickerOptions).then(result => {\n      this.files = result[0];\n      this.filesSrc = result[1];\n      this.filenames = result[2];\n    }).catch(err => {\n      this.toastComponent.presentToast(\n        `No se pudo seleccionar la imagen, error: ${err}`, 'middle', 2500);\n    });\n  }\n\n  uploadFile() {\n    this.loadingSpinnerComponent.presentLoadingSpinner('guardando imagen').then(() => {\n      const API_URL = environment.API_URL;\n      const uri = encodeURI(`${API_URL}${this.V1}drivers/profile/image`);\n      const headers = {\n        'Content-Type': 'multipart/form-data',\n        Authorization: 'Bearer ' + this.authToken,\n      };\n      this.http.uploadFile(uri, null, headers, this.files[0], 'file')\n        .then((data) => {\n          this.loadingSpinnerComponent.dismissLoadingSpinner();\n          this.filenames = [];\n          this.filesSrc = [];\n          this.files = [];\n          this.getProfile();\n        }).catch(err => {\n        this.loadingSpinnerComponent.dismissLoadingSpinner();\n        this.toastComponent.presentToast(\n          `No se pudo guardar la imagen, error: ${JSON.stringify(err)}`, 'middle', 2500);\n      });\n    });\n  }\n\n  onToggleChange(ev) {\n    console.log(ev.detail.checked);\n    if (ev.detail.checked) {\n      this.presentAlertConfirm();\n    } else {\n      this.updateDriverContractor(false);\n    }\n  }\n\n  async presentAlertConfirm() {\n    const alert = await this.alertController.create({\n      header: 'Confirmar',\n      message: 'Por favor confirma que trabajas para una empresa de logística',\n      buttons: [\n        {\n          text: 'Cancelar',\n          role: 'cancel',\n          cssClass: 'secondary',\n          handler: (blah) => {\n            console.log('Confirm Cancel: blah');\n          }\n        }, {\n          text: 'Ok',\n          handler: () => {\n            this.updateDriverContractor(true);\n          }\n        }\n      ]\n    });\n\n    await alert.present();\n  }\n\n  updateDriverContractor(hasContractor) {\n    const body = {\n      has_contractor: hasContractor\n    };\n    this.driverService.updateContractor(body)\n      .subscribe((response: any) => {\n\n      });\n  }\n\n  doRefresh(event) {\n    console.log('Begin async operation');\n\n    setTimeout(() => {\n      console.log('Async operation has ended');\n      this.getProfile();\n      event.target.complete();\n    }, 2000);\n  }\n}\n"]}